# VAIB System v14.0 (Grace Hybrid)

Это репозиторий с конфигурациями для AI-агентов, реализующих методологию **VAIB** (Virtual AI Bureau). Система предназначена для структурированной разработки программного обеспечения с использованием больших языковых моделей (LLM) в средах **Kilocode** и **OpenCode**.

## Суть методологии

Главная проблема работы с LLM в кодинге — потеря контекста и "галлюцинации" при редактировании больших файлов. Агенты часто стирают нужные куски кода, забывают структуру или нарушают логику, если не ограничить их свободу.

Система решает это через **GRACE Markup** (Grounding Anchors for Code Evolution). Это набор обязательных комментариев-якорей, которые агенты обязаны вставлять в код и соблюдать при редактировании.

Пример разметки:
```javascript
// # START_BLOCK_AUTH_LOGIC
// # START_CONTRACT: Validate user token and return session
function validateSession(token) { ... }
// # END_BLOCK_AUTH_LOGIC
```

Агенты используют эти якоря для навигации: "Редактор" ищет конкретный блок и меняет только его содержимое, не затрагивая остальной файл.

## Структура репозитория
```
.
├── .kilocodemodes          # Единый конфиг-файл для среды Kilocode
├── opencode-agents/        # Отдельные .md файлы для среды OpenCode
│   ├── vaib0-archaeologist.md
│   ├── vaib1-analyst.md
│   ├── vaib2-architect.md
│   ├── vaib3-spec.md
│   ├── vaib4-coder.md
│   ├── vaib5-tester.md
│   └── vaib6-edit.md
└── README.md
```

## Роли агентов (Workflow)
Система делит процесс разработки на 7 этапов. Каждый агент — это узкоспециализированный инструмент с жестким системным промптом.

### 1. Onboarding & Analysis
Archaeologist (v0): Используется для работы с легаси-кодом. Сканирует проект и расставляет GRACE-якоря, чтобы подготовить код к автоматизированной обработке.

Analyst (v1): Интервьюер. Собирает требования с пользователя по модели AAG (Actor-Action-Goal) и формирует файл требований.

Architect (v2): Превращает требования в технический план (development_plan.md) и контракты модулей. Проводит "мысленные тесты" архитектуры до написания кода.

### 2. Implementation Loop (Creation)
Spec (v3): Проверяет доступность библиотек и документации. Если используется внешняя библиотека, скачивает её документацию в проект, чтобы Кодер не выдумывал API.

Coder (v4): "Генератор". Пишет код с нуля на основе плана Архитектора. Обязан создавать базовые тесты (Happy Path) и проверять синтаксис перед сдачей.

### 3. Quality Assurance Loop (Verification)
Tester (v5): Роль SDET (Software Development Engineer in Test). Не просто запускает тесты, а анализирует логи и соответствие "Веры" агента ([Belief]) реальности. Если тестов нет — пишет их сам на основе Контрактов.

При обнаружении бага в логике возвращает задачу Кодеру.

При мелких ошибках в существующем коде передает задачу Редактору.

### 4. Maintenance Loop (Evolution)
Editor (v6): "Хирург". Используется для поддержки живого кода. В отличие от Кодера, он никогда не переписывает файл целиком. Он находит нужный # START_BLOCK, меняет строки внутри и сохраняет файл. Это минимизирует риск поломки работающего функционала.

## Установка и использование
### Для OpenCode
Скопируйте файлы из папки opencode-agents/ в директорию конфигурации ваших агентов:

Глобально: ~/.config/opencode/agents/

Или в корень проекта: .opencode/agents/

Агенты станут доступны в интерфейсе (переключение через Tab) или через упоминание @vaib....

### Для Kilocode
Откройте настройки Kilocode.

Скопируйте содержимое файла .kilocodemodes.

Вставьте в секцию customModes вашего конфигурационного файла.

## Особенности v14.0
Agentic Loops: Агенты OpenCode настроены на перекрестный вызов (Tester может вызывать Coder/Editor).

Syntax Sanity Check: Кодер и Редактор автоматически проверяют синтаксис (linter/compiler) перед завершением работы.

Russian Comments: По умолчанию агенты настроены оставлять комментарии к коду на русском языке для сохранения семантической ясности намерения (Intent).